<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
<base th:href="@{/}">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ä¿®æ”¹å¯†ç  - eBusiness</title>
<link rel="stylesheet" href="css/bootstrap.min.css" />
<link rel="stylesheet" href="css/custom.css" />
<script src="js/jquery.min.js"></script>
<script src="js/bootstrap.min.js"></script>
<script>
	function validateForm() {
		var newPwd = document.myform.newPassword.value;
		var confirmPwd = document.myform.confirmPassword.value;
		var captcha = document.myform.captcha.value;
		
		if (newPwd.length < 6) {
			showAlert('æ–°å¯†ç è‡³å°‘éœ€è¦6ä½å­—ç¬¦', 'warning');
			return false;
		}
		if (newPwd !== confirmPwd) {
			showAlert('ä¸¤æ¬¡è¾“å…¥çš„æ–°å¯†ç ä¸ä¸€è‡´', 'warning');
			return false;
		}
		if (!captcha) {
			showAlert('è¯·è¾“å…¥éªŒè¯ç ', 'warning');
			return false;
		}
		return true;
	}
	
	function showAlert(message, type) {
		var alertClass = type === 'warning' ? 'alert-warning' : 'alert-success';
		var alertHtml = '<div class="alert alert-custom ' + alertClass + ' alert-dismissible" role="alert" style="position: fixed; top: 20px; left: 50%; transform: translateX(-50%); z-index: 10000; min-width: 300px;">' +
			'<button type="button" class="close" data-dismiss="alert"><span>&times;</span></button>' +
			'<strong>' + message + '</strong></div>';
		$('body').append(alertHtml);
		setTimeout(function() {
			$('.alert').fadeOut(500, function() { $(this).remove(); });
		}, 3000);
	}
</script>
<style>
	body {
		background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
		min-height: 100vh;
		display: flex;
		align-items: center;
		justify-content: center;
		padding: 20px;
	}
</style>
</head>
<body>
	<div class="form-custom" style="max-width: 600px; width: 100%;">
		<div class="form-header">
			<h3>ğŸ” ä¿®æ”¹å¯†ç </h3>
			<p style="margin: 10px 0 0 0; font-size: 14px; opacity: 0.9;">ä¸ºäº†æ‚¨çš„è´¦æˆ·å®‰å…¨ï¼Œè¯·å®šæœŸæ›´æ¢å¯†ç </p>
		</div>
		
		<!-- é”™è¯¯/æˆåŠŸæç¤º -->
		<div th:if="${msg}" class="alert alert-custom alert-warning">
			<strong>âš ï¸ </strong><span th:text="${msg}"></span>
		</div>
		
		<form action="cart/updatePassword" name="myform" method="post" role="form" onsubmit="return validateForm();">
			<!-- æ˜¾ç¤ºå½“å‰ç™»å½•ç”¨æˆ· -->
			<div class="form-group">
				<label>ğŸ‘¤ å½“å‰ç™»å½•é‚®ç®±</label>
				<div style="padding: 12px 20px; background: #F8F9FA; border-radius: 8px; color: #2C3E50; font-weight: 600;">
					<span sec:authentication="name">guest@example.com</span>
				</div>
			</div>
			
			<div class="form-group">
				<label>ğŸ”‘ æ–°å¯†ç </label>
				<input type="password" class="form-control" name="newPassword" 
					   placeholder="è¯·è¾“å…¥6-20ä½æ–°å¯†ç " required minlength="6" maxlength="20" />
				<p style="margin-top: 8px; color: #6C757D; font-size: 13px;">
					ğŸ’¡ å»ºè®®ä½¿ç”¨å­—æ¯ã€æ•°å­—å’Œç¬¦å·çš„ç»„åˆ
				</p>
			</div>
			
			<div class="form-group">
				<label>ğŸ”‘ ç¡®è®¤æ–°å¯†ç </label>
				<input type="password" class="form-control" name="confirmPassword" 
					   placeholder="è¯·å†æ¬¡è¾“å…¥æ–°å¯†ç " required minlength="6" maxlength="20" />
			</div>
			
			<div class="form-group">
				<label>ğŸ”¢ éªŒè¯ç </label>
				<div style="display: flex; gap: 10px; align-items: center;">
					<input type="text" class="form-control" name="captcha" 
						   placeholder="è¯·è¾“å…¥éªŒè¯ç " required style="flex: 1;" />
					<img th:src="@{/validateCode}" id="mycode_userinfo" 
						 th:attr="onclick=|this.src='@{/validateCode}?'+Math.random()|" 
						 style="height: 46px; border-radius: 8px; cursor: pointer; border: 2px solid #E9ECEF;"
						 title="ç‚¹å‡»åˆ·æ–°éªŒè¯ç " />
				</div>
				<p style="margin-top: 8px; color: #6C757D; font-size: 13px;">
					ğŸ’¡ çœ‹ä¸æ¸…ï¼Ÿç‚¹å‡»å›¾ç‰‡åˆ·æ–°
				</p>
			</div>
			
			<div class="form-group" style="margin-top: 30px;">
				<button type="submit" class="btn btn-custom-primary btn-block btn-lg">
					ä¿®æ”¹å¯†ç 
				</button>
			</div>
			
			<div class="form-group text-center">
				<button type="reset" class="btn btn-default">é‡ç½®</button>
				<span style="margin: 0 10px; color: #CCC;">|</span>
				<a href="/" style="color: #667eea; font-weight: 600;">è¿”å›é¦–é¡µ</a>
			</div>
		</form>
		
		<!-- å®‰å…¨æç¤º -->
		<div style="margin-top: 30px; padding: 20px; background: #F8F9FA; border-radius: 12px;">
			<h4 style="font-size: 14px; font-weight: 600; margin-bottom: 10px; color: #2C3E50;">
				ğŸ›¡ï¸ å®‰å…¨å»ºè®®
			</h4>
			<ul style="margin: 0; padding-left: 20px; color: #6C757D; font-size: 13px; line-height: 1.8;">
				<li>å®šæœŸæ›´æ¢å¯†ç ï¼Œå»ºè®®æ¯3ä¸ªæœˆæ›´æ¢ä¸€æ¬¡</li>
				<li>ä¸è¦ä½¿ç”¨è¿‡äºç®€å•çš„å¯†ç </li>
				<li>ä¸è¦åœ¨å¤šä¸ªç½‘ç«™ä½¿ç”¨ç›¸åŒå¯†ç </li>
			</ul>
		</div>
	</div>
</body>
</html>