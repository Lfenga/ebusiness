<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>导航页</title>
<base th:href="@{/}">
<!-- Bootstrap -->
<link href="css/bootstrap.min.css" rel="stylesheet">
<link href="css/custom.css" rel="stylesheet">
<script src="js/jquery.min.js"></script>
<script src="js/bootstrap.min.js"></script>
<script src="js/common.js"></script>
<!-- 星空特效 -->
<script src="js/starfield.js"></script>
<!-- 粒子特效 -->
<script src="js/particles.js"></script>
</head>
<body>
	<!-- 顶部导航栏 -->
	<nav class="navbar navbar-custom navbar-fixed-top" role="navigation">
		<div class="container-fluid">
			<!-- 移动端导航切换按钮 -->
			<div class="navbar-header">
				<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#main-navbar">
					<span class="sr-only">切换导航</span>
					<span class="icon-bar" style="background-color: white;"></span>
					<span class="icon-bar" style="background-color: white;"></span>
					<span class="icon-bar" style="background-color: white;"></span>
				</button>
				<a class="navbar-brand" href="#">🛒 eBusiness</a>
			</div>
			
			<!-- 导航链接 -->
			<div class="collapse navbar-collapse" id="main-navbar">
				<ul class="nav navbar-nav">
					<li><a th:href="@{user/toRegister}">📝 注册</a></li>
					<li>
						<a th:href="(${session.bUser} == null)?'user/toLogin':'#'" >
							<span th:if="${session.bUser} == null">🔐 登录</span>
							<span th:if="${session.bUser} != null">
								👋 欢迎 <strong th:text="${session.bUser.bemail}"></strong>
							</span>
						</a>
					</li>
					<li><a th:href="@{admin/toLogin}">⚙️ 后台管理</a></li>
				</ul>
				
				<ul class="nav navbar-nav navbar-right">
					<li><a th:href="@{/cart/userInfo}">👤 个人信息</a></li>
					<li><a th:href="@{/cart/selectCart}">🛒 购物车</a></li>
					<li><a th:href="@{/cart/myOder}">📦 我的订单</a></li>
					<li class="dropdown">
						<a href="#" data-toggle="dropdown" class="dropdown-toggle">
							ℹ️ 关于我们 <span class="caret"></span>
						</a>
						<ul class="dropdown-menu">
							<li><a href="#">📞 联系我们</a></li>
							<li><a href="#">💬 投诉建议</a></li>
						</ul>
					</li>
					<li th:if="${session.bUser} != null">
						<a href="javascript:void(0)" onclick="confirmLogout()">
							🚪 退出登录
						</a>
					</li>
				</ul>
			</div>
		</div>
	</nav>
	
	<script>
	function confirmLogout() {
		// 暂时使用原生confirm来确保功能能正常工作
		if (confirm('确定要退出登录吗？退出后需要重新登录才能使用相关功能。')) {
			performLogout();
		}
		
		// 后续可以恢复Element Plus风格的对话框
		/*
		if (typeof window.showConfirm === 'function') {
			// 使用Element Plus风格的确认对话框
			window.showConfirm(
				'确定要退出登录吗？',
				'退出后需要重新登录才能使用相关功能',
				function() {
					// 确认退出
					performLogout();
				}
			);
		} else {
			// 降级处理：使用原生确认对话框
			if (confirm('确定要退出登录吗？')) {
				performLogout();
			}
		}
		*/
	}
	
	function performLogout() {
		// 直接跳转到我们自定义的logout方法
		window.location.href = 'user/userLogout';
	}
	</script>
	
	<!-- 商品分类导航栏（顺序调整到主导航栏下方，去除fixed-top） -->
	<!-- 两个导航栏紧贴在一起，无间隔 -->
	<nav class="navbar navbar-categories" role="navigation" style="margin-top: 0; position: static;">
		<div class="container-fluid">
			<div class="navbar-header">
				<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#category-navbar">
					<span class="sr-only">切换分类</span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
				</button>
			</div>
			
			<div class="collapse navbar-collapse" id="category-navbar">
				<ul class="nav navbar-nav">
					<li><a th:href="@{/}">🏠 首页</a></li>
					<li th:each="gty:${goodsType}">
						<a th:href="'?tid=' + ${gty.id}">
							<span th:text="${gty.typename}"></span>
						</a>
					</li>
				</ul>
				
				<form action="search" class="navbar-form navbar-right" role="search">
					<div class="form-group">
						<input type="text" class="form-control" name="mykey" 
							   placeholder="🔍 搜索商品..." 
							   style="width: 250px;" />
					</div>
					<button type="submit" class="btn btn-search">搜索</button>
				</form>
			</div>
		</div>
	</nav>
</body>
</html>
