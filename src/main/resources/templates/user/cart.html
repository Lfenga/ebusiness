<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<base th:href="@{/}">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>è´­ç‰©è½¦ - eBusiness</title>
<link rel="stylesheet" href="css/bootstrap.min.css" />
<link rel="stylesheet" href="css/custom.css" />
<script src="js/jquery.min.js"></script>
<script src="js/bootstrap.min.js"></script>
<script src="js/common.js"></script>
<script src="js/starfield.js"></script>
<script src="js/particles.js"></script>
<script type="text/javascript">
	function deleteCart(obj){
		if (typeof window.showConfirm === 'function') {
			// ä½¿ç”¨Element Plusé£æ ¼çš„ç¡®è®¤å¯¹è¯æ¡†
			window.showConfirm(
				'ç¡®è®¤åˆ é™¤è¯¥å•†å“å—ï¼Ÿ',
				'åˆ é™¤åæ— æ³•æ¢å¤ï¼Œè¯·è°¨æ…æ“ä½œ',
				function() {
					//è·å–è·¯å¾„
					var pathName=window.document.location.pathname;
					//æˆªå–ï¼Œå¾—åˆ°é¡¹ç›®åç§°
					var projectName=pathName.substring(0,pathName.substr(1).indexOf('/')+1);
					window.location.href = projectName + "/cart/deleteCart?gid=" + obj;
				}
			);
		} else {
			// é™çº§å¤„ç†ï¼šä½¿ç”¨åŸç”Ÿç¡®è®¤å¯¹è¯æ¡†
			if(window.confirm("ç¡®è®¤åˆ é™¤è¯¥å•†å“å—ï¼Ÿ")){
				//è·å–è·¯å¾„
				var pathName=window.document.location.pathname;
				//æˆªå–ï¼Œå¾—åˆ°é¡¹ç›®åç§°
				var projectName=pathName.substring(0,pathName.substr(1).indexOf('/')+1);
				window.location.href = projectName + "/cart/deleteCart?gid=" +  obj;
			}
		}
	}
	
	function clearCart(){
		if (typeof window.showConfirm === 'function') {
			// ä½¿ç”¨Element Plusé£æ ¼çš„ç¡®è®¤å¯¹è¯æ¡†
			window.showConfirm(
				'ç¡®è®¤æ¸…ç©ºè´­ç‰©è½¦å—ï¼Ÿ',
				'æ­¤æ“ä½œä¸å¯æ¢å¤ï¼Œå°†åˆ é™¤æ‰€æœ‰å•†å“ï¼',
				function() {
					//è·å–è·¯å¾„
					var pathName=window.document.location.pathname;
					//æˆªå–ï¼Œå¾—åˆ°é¡¹ç›®åç§°
					var projectName=pathName.substring(0,pathName.substr(1).indexOf('/')+1);
					window.location.href = projectName + "/cart/clearCart";
				}
			);
		} else {
			// é™çº§å¤„ç†ï¼šä½¿ç”¨åŸç”Ÿç¡®è®¤å¯¹è¯æ¡†
			if(window.confirm("ç¡®è®¤æ¸…ç©ºè´­ç‰©è½¦å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ï¼")){
				//è·å–è·¯å¾„
				var pathName=window.document.location.pathname;
				//æˆªå–ï¼Œå¾—åˆ°é¡¹ç›®åç§°
				var projectName=pathName.substring(0,pathName.substr(1).indexOf('/')+1);
				window.location.href = projectName + "/cart/clearCart";
			}
		}
	}
	
	// é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–åŠ¨ç”»
	$(document).ready(function() {
		// ä¸ºè´­ç‰©è½¦é‡‘é¢æ·»åŠ æ•°å­—æ»šåŠ¨åŠ¨ç”»
		$('.total-amount span').each(function() {
			var finalValue = parseFloat($(this).text());
			if (!isNaN(finalValue) && window.particleSystem) {
				window.particleSystem.animateNumber(this, 0, finalValue, 1000);
			}
		});
	});
</script>
</head>
<body>
<div th:include="user/header"></div>

<div class="container page-transition" style="margin-top: 30px; margin-bottom: 60px;">
	<!-- é¢åŒ…å±‘å¯¼èˆª -->
	<ol class="breadcrumb breadcrumb-custom">
		<li><a th:href="@{/}">é¦–é¡µ</a></li>
		<li class="active">è´­ç‰©è½¦</li>
	</ol>
	
	<div class="panel-custom">
		<div class="panel-heading">
			<h3 class="panel-title">ğŸ›’ æˆ‘çš„è´­ç‰©è½¦</h3>
		</div>
		<div class="panel-body">
			<!-- è´­ç‰©è½¦è¡¨æ ¼ -->
			<div class="table-responsive">
				<table class="table table-custom">
					<thead>
						<tr>
							<th class="text-center">å•†å“ä¿¡æ¯</th>
							<th class="text-center">å•†å“åç§°</th>
							<th class="text-center">å•ä»·ï¼ˆå…ƒï¼‰</th>
							<th class="text-center">æ•°é‡</th>
							<th class="text-center">å°è®¡ï¼ˆå…ƒï¼‰</th>
							<th class="text-center">æ“ä½œ</th>
						</tr>
					</thead>
					<tbody>
						<tr th:each="cart:${cartlist}">
							<td class="text-center">
								<a th:href="'goodsDetail?id=' + ${cart.id}"> 
									<img th:src="'images/' + ${cart.gpicture}"
										 class="table-img"
										 alt="å•†å“å›¾ç‰‡">
								</a>
							</td>
							<td class="text-center" style="vertical-align: middle;">
								<a th:href="'goodsDetail?id=' + ${cart.id}" 
								   style="color: #2C3E50; font-weight: 600; text-decoration: none;">
									<span th:text="${cart.gname}"></span>
								</a>
							</td>
							<td class="text-center" style="vertical-align: middle;">
								<span style="color: var(--primary-color); font-weight: 700; font-size: 18px;">
									Â¥<span th:text="${cart.grprice}"></span>
								</span>
							</td>
							<td class="text-center" style="vertical-align: middle;">
								<span class="badge-custom" style="background: #E9ECEF; color: #2C3E50; font-size: 16px;">
									<span th:text="${cart.shoppingnum}"></span>
								</span>
							</td>
							<td class="text-center" style="vertical-align: middle;">
								<span style="color: var(--primary-color); font-weight: 700; font-size: 20px;">
									Â¥<span th:text="${cart.smallsum}"></span>
								</span>
							</td>
							<td class="text-center" style="vertical-align: middle;">
								<a th:href="'javascript:deleteCart('+${cart.id}+')'" 
								   class="btn btn-danger btn-sm">
									ğŸ—‘ï¸ åˆ é™¤
								</a>
							</td>
						</tr>
						
						<!-- ç©ºè´­ç‰©è½¦æç¤º -->
						<tr th:if="${#lists.isEmpty(cartlist)}">
							<td colspan="6">
								<div class="empty-state">
									<div class="empty-state-icon">ğŸ›’</div>
									<p class="empty-state-text">è´­ç‰©è½¦ç©ºç©ºå¦‚ä¹Ÿ</p>
									<a href="/" class="btn btn-custom-primary">å»è´­ç‰©</a>
								</div>
							</td>
						</tr>
					</tbody>
				</table>
			</div>
			
			<!-- è´­ç‰©è½¦æ±‡æ€» -->
			<div th:unless="${#lists.isEmpty(cartlist)}">
				<div class="cart-summary">
					<div class="row">
						<div class="col-sm-6">
							<h4 style="color: white; margin: 0;">è´­ç‰©è½¦ç»Ÿè®¡</h4>
							<p style="color: rgba(255,255,255,0.8); margin: 5px 0 0 0;">
								å…± <strong th:text="${#lists.size(cartlist)}">0</strong> ä»¶å•†å“
							</p>
						</div>
						<div class="col-sm-6 text-right">
							<p style="color: rgba(255,255,255,0.9); margin: 0; font-size: 16px;">
								å•†å“æ€»é¢ï¼ˆä¸å«è¿è´¹ï¼‰
							</p>
							<div class="total-amount">
								Â¥<span th:text="${total}">0</span>
							</div>
						</div>
					</div>
				</div>
				
				<!-- æ“ä½œæŒ‰é’® -->
				<div class="cart-actions">
					<a href="javascript:clearCart()" class="btn btn-default btn-lg">
						ğŸ—‘ï¸ æ¸…ç©ºè´­ç‰©è½¦
					</a>
					<a href="/" class="btn btn-custom-secondary btn-lg">
						ç»§ç»­è´­ç‰©
					</a>
					<a href="cart/selectCart?act=toCount" class="btn btn-custom-primary btn-lg btn-icon">
						<span style="font-size: 18px;">ğŸ’³</span>
						<span>å»ç»“ç®—</span>
					</a>
				</div>
			</div>
		</div>
	</div>
	
	<!-- æ¸©é¦¨æç¤º -->
	<div class="alert alert-custom alert-info" th:unless="${#lists.isEmpty(cartlist)}">
		<strong>ğŸ’¡ æ¸©é¦¨æç¤ºï¼š</strong>
		<ul style="margin: 10px 0 0 20px; padding: 0;">
			<li>å•†å“ä»·æ ¼å¯èƒ½ä¼šæœ‰å˜åŠ¨ï¼Œè¯·ä»¥ç»“ç®—æ—¶ä»·æ ¼ä¸ºå‡†</li>
			<li>åº“å­˜æ•°é‡æœ‰é™ï¼Œå»ºè®®å°½å¿«ç»“ç®—</li>
			<li>æ»¡99å…ƒåŒ…é‚®ï¼Œè¿˜å·®ä¸€ç‚¹å°±åŒ…é‚®å•¦ï¼</li>
		</ul>
	</div>
</div>
</body>
</html>