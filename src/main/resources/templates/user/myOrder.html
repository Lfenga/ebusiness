<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<base th:href="@{/}">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>æˆ‘çš„è®¢å• - eBusiness</title>
<link rel="stylesheet" href="css/bootstrap.min.css" />
<link rel="stylesheet" href="css/custom.css" />
<script src="js/jquery.min.js"></script>
<script src="js/bootstrap.min.js"></script>
<script type="text/javascript" th:inline="javascript">
	function pay(){
		$.ajax({
			url : [[@{/cart/pay}]],
			type : "post",
			contentType : "application/json",
			data : JSON.stringify({
				id : $("#oid").text()
			}),
			success : function(obj){
				showAlert("æ”¯ä»˜æˆåŠŸï¼", "success");
				setTimeout(function() {
					var pathName=window.document.location.pathname;
					var projectName=pathName.substring(0,pathName.substr(1).indexOf('/')+1);
					window.location.href = projectName;
				}, 1500);
			},
	        error : function() {
	            showAlert("å¤„ç†å¼‚å¸¸ï¼Œè¯·ç¨åé‡è¯•ï¼", "warning");
	        }
		});
	}
	
	function showAlert(message, type) {
		var alertClass = type === 'warning' ? 'alert-warning' : 'alert-success';
		var alertHtml = '<div class="alert alert-custom ' + alertClass + ' alert-dismissible" role="alert" style="position: fixed; top: 140px; left: 50%; transform: translateX(-50%); z-index: 10000; min-width: 300px;">' +
			'<button type="button" class="close" data-dismiss="alert"><span>&times;</span></button>' +
			'<strong>' + message + '</strong></div>';
		$('body').append(alertHtml);
		setTimeout(function() {
			$('.alert').fadeOut(500, function() { $(this).remove(); });
		}, 3000);
	}
</script>
</head>
<body>
<div th:include="user/header"></div>

<div class="container" style="margin-top: 30px; margin-bottom: 60px;">
	<!-- é¢åŒ…å±‘å¯¼èˆª -->
	<ol class="breadcrumb breadcrumb-custom">
		<li><a href="/">é¦–é¡µ</a></li>
		<li class="active">æˆ‘çš„è®¢å•</li>
	</ol>
	
	<div class="panel-custom">
		<div class="panel-heading">
			<h3 class="panel-title">ğŸ“¦ æˆ‘çš„è®¢å•</h3>
		</div>
		<div class="panel-body">
			<div class="table-responsive">
				<table class="table table-custom">
					<thead>
						<tr>
							<th class="text-center">è®¢å•ç¼–å·</th>
							<th class="text-center">è®¢å•é‡‘é¢</th>
							<th class="text-center">è®¢å•çŠ¶æ€</th>
							<th class="text-center">ä¸‹å•æ—¶é—´</th>
							<th class="text-center">æ“ä½œ</th>
						</tr>
					</thead>
					<tbody>
						<tr th:each="order:${myOrder}">
							<td class="text-center" style="vertical-align: middle; font-weight: 600;">
								<span id="oid" th:text="${order.id}"></span>
							</td>
							<td class="text-center" style="vertical-align: middle;">
								<span style="color: #FF6B6B; font-weight: 700; font-size: 18px;">
									Â¥<span th:text="${order.amount}"></span>
								</span>
							</td>
							<td class="text-center" style="vertical-align: middle;">
								<span th:if="${order.status} == 0" class="status-badge status-unpaid">
									ğŸ’° å¾…æ”¯ä»˜
								</span>
								<span th:if="${order.status} == 1" class="status-badge status-paid">
									âœ… å·²æ”¯ä»˜
								</span>
							</td>
							<td class="text-center" style="vertical-align: middle; color: #6C757D;">
								<span th:text="${order.orderdate}"></span>
							</td>
							<td class="text-center" style="vertical-align: middle;">
								<a th:href="'cart/orderDetail?id=' + ${order.id}" 
								   class="btn btn-sm btn-custom-secondary" 
								   target="_blank">
									ğŸ‘ï¸ æŸ¥çœ‹è¯¦æƒ…
								</a>
								<button th:if="${order.status} == 0" 
										onclick="pay()" 
										class="btn btn-sm btn-custom-primary" 
										style="margin-left: 5px;">
									ğŸ’³ å»æ”¯ä»˜
								</button>
							</td>
						</tr>
						<!-- ç©ºçŠ¶æ€æç¤º -->
						<tr th:if="${#lists.isEmpty(myOrder)}">
							<td colspan="5">
								<div class="empty-state">
									<div class="empty-state-icon">ğŸ“¦</div>
									<p class="empty-state-text">æš‚æ— è®¢å•è®°å½•</p>
									<a href="/" class="btn btn-custom-primary">å»è´­ç‰©</a>
								</div>
							</td>
						</tr>
					</tbody>
				</table>
			</div>
		</div>
	</div>
</div>
</body>
</html>